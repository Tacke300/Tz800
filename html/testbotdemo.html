<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Control Bot</title>
</head>
<body>
  <h3>Chọn loại bot:</h3>
  <button onclick="startBot('mini')">Chạy bot Mini</button>
  <button onclick="startBot('big')">Chạy bot Big</button>
  <button onclick="startBot('set')">Chạy bot Set</button>
  <button onclick="stopBot()">Dừng Bot</button>

  <h3>Bot Set Input:</h3>
  <input type="number" id="amount" placeholder="Số $ vào lệnh" min="1" max="10000" />
  <input type="number" id="lev" placeholder="Đòn bẩy" min="1" max="125" />
  <input type="number" id="tp" placeholder="TP theo % vốn" min="1" max="100" />
  <input type="number" id="sl" placeholder="SL theo % vốn" min="1" max="100" />

  <p id="status"></p>

  <script>
    async function startBot(type) {
      const user_id = localStorage.getItem('loggedInUser');
      if (!user_id) return alert('Không có user');

      const params = new URLSearchParams({ user_id });

      if (type === 'set') {
        const amount = document.getElementById('amount').value;
        const lev = document.getElementById('lev').value;
        const tp = document.getElementById('tp').value;
        const sl = document.getElementById('sl').value;

        if (!amount || !lev || !tp || !sl) return alert('Điền đủ thông tin bot set');
        params.append('amount', amount);
        params.append('lev', lev);
        params.append('tp', tp);
        params.append('sl', sl);
      }

      const res = await fetch(`http://34.145.69.100:3000/start/${type}?${params.toString()}`);
      const msg = await res.text();
      document.getElementById('status').innerText = msg;
    }

    async function stopBot() {
      const res = await fetch('http://34.145.69.100:3000/stop');
      const msg = await res.text();
      document.getElementById('status').innerText = msg;
    }
  </script>
</body>
</html>
